{{ define "main" }}
    <div class="project__content">
        {{/* TODO: use webp */}}
        {{ $webpBg := resources.Get (print "images/" $.Params.Image) | minify | fingerprint }}
        {{ $jpgBg := resources.Get (print "images/" $.Params.Image) | minify | fingerprint }}
        {{ $sizes := slice "272" "327" "366" "461" "576" "666" "768" }}
        <a href="{{ $webpBg.Permalink }}" target="_blank" rel="noopener" class="slide slide-right">
            <picture>
                {{ range $sizes }}
                    <source media="(max-width: {{ . }}px)"
                            srcset='{{ ($webpBg.Resize (print . "x q100")).Permalink }}'/>
                {{ end }}
                <img src="{{ $webpBg.Permalink }}"
                     class="project__image"
                     aria-hidden="true"
                     loading="lazy"
                     width="768" height="480"
                     onerror="this.onerror = null; this.src = '{{ $jpgBg.Permalink }}'"
                     alt="{{ $.Title}} Screenshot Preview"/>
            </picture>
        </a>
        <div class="project__attributes slide slide-left">
            <h1 class="project__title">{{ $.Title }}</h1>

            <div class="project__attribute">
                <div class="project__attribute__label">Client</div>
                <div>{{ $.Params.Client }}</div>
            </div>

            <div class="project__attribute">
                <div class="project__attribute__label">Contributors</div>
                <div>
                    {{ range $index, $contributor := $.Params.Contributors }}
                        {{ $contributor }}{{ if ne $index (sub (len $.Params.Contributors) 1) }},{{ end }}
                    {{ end }}
                </div>
            </div>

            <div class="project__attribute">
                <div class="project__attribute__label">Languages</div>
                <div>
                    {{ range $index, $language := $.Params.Languages }}
                        {{ $language }}{{ if ne $index (sub (len $.Params.Languages) 1) }},{{ end }}
                    {{ end }}
                </div>
            </div>

            <div class="project__attribute">
                <div class="project__attribute__label">Location</div>
                <div><a href="{{ $.Params.Location }}" target="_blank" rel="noopener">{{ $.Params.Location }}</a></div>
            </div>

            <div class="project__attribute">
                <div class="project__attribute__label">Technologies</div>
                {{ range $technology := $.Params.Technologies }}
                    {{ partial "partials/technology-link.html" (dict "technology" $technology ) }}
                {{ end }}
            </div>
        </div>
    </div>

    <div class="project__details slide slide-up">
        <div>
            {{/* Description is a reserved keyword in Hugo for params. */}}
            <h2 class="project__details__h2">Details</h2>
            {{ range $.Params.Details }}
                <p class="project__details__p">{{ . }}</p>
            {{ end }}
        </div>

        <div>
            <h2 class="project__details__h2">Contributions</h2>
            {{ range $.Params.Contributions }}
                <p class="project__details__p">{{ . }}</p>
            {{ end }}
        </div>

        <div>
            <h2 class="project__details__h2">Obstacles</h2>
            {{ range $.Params.Obstacles }}
                <p class="project__details__p">{{ . }}</p>
            {{ end }}
        </div>
    </div>
    {{ .Content }}
{{ end }}